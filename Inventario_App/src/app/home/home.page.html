<ion-header>
  <ion-toolbar class="home-toolbar">
    <div class="home-toolbar-left">
      <ion-title>Inventario</ion-title>
    </div>

    <div class="home-toolbar-right">
      <!-- Avatar con inicial -->
      <button type="button" class="avatar-button" (click)="goPerfil()">
        <div class="avatar-circle">
          <span *ngIf="!isLoadingProfile">{{ avatarLetter }}</span>
        </div>
      </button>

      <!-- Botón logout -->
      <ion-button fill="clear" size="small" (click)="logout()">
        <ion-icon slot="icon-only" name="log-out-outline"></ion-icon>
      </ion-button>
    </div>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="home-content ion-padding">

  <!-- Encabezado de bienvenida -->
  <section class="home-header">
    <p class="home-subtitle">Bienvenido(a)</p>

    <div class="home-user-row">
      <h2 *ngIf="!isLoadingProfile">Hola, {{ displayName }}</h2>
      <div class="home-user-loading" *ngIf="isLoadingProfile">
        <ion-spinner name="lines"></ion-spinner>
        <span>Cargando usuario...</span>
      </div>
    </div>

    <p class="home-description">
      Gestiona el inventario escaneando estantes, registrando productos y manteniendo todo sincronizado
      con la bodega central.
    </p>
  </section>

  <!-- Acciones principales -->
  <!-- Acciones principales -->
  <ion-card class="home-card home-actions">
    <ion-card-header>
      <ion-card-title>Acciones rápidas</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <div class="actions-grid">
        <ion-button expand="block" shape="round" class="btn-primary" (click)="goScan()">
          <ion-icon slot="start" name="qr-code-outline"></ion-icon>
          Escanear estante (QR)
        </ion-button>

        <ion-button expand="block" shape="round" class="btn-secondary" (click)="goAddProduct()">
          <ion-icon slot="start" name="cube-outline"></ion-icon>
          Agregar producto
        </ion-button>

        <ion-button expand="block" shape="round" class="btn-outline" (click)="goSearchProduct()">
          <ion-icon slot="start" name="search-outline"></ion-icon>
          Buscar producto
        </ion-button>

        <ion-button expand="block" shape="round" class="btn-ghost" (click)="syncInventario()">
          <ion-icon slot="start" name="sync-outline"></ion-icon>
          Sincronizar inventario
        </ion-button>
      </div>
    </ion-card-content>
  </ion-card>


  <!-- Sección bodegas -->
  <section class="home-section">
    <div class="home-section-header">
      <h3>Bodegas disponibles</h3>
      <ion-button size="small" fill="clear" (click)="loadWarehouses()">
        <ion-icon class="letra" slot="start" name="sync-outline" class="letra"></ion-icon>
        Actualizar
      </ion-button>
    </div>

    <!-- Estado de carga -->
    <div *ngIf="isLoadingWarehouses" class="loading-state">
      <ion-spinner name="lines"></ion-spinner>
      <p>Cargando bodegas...</p>
    </div>

    <!-- Lista de bodegas -->
    <ng-container *ngIf="!isLoadingWarehouses">
      <ion-card *ngIf="!warehouses.length" class="home-card">
        <ion-card-content>
          Aún no hay bodegas registradas en el sistema.
        </ion-card-content>
      </ion-card>

      <ion-list *ngIf="warehouses.length" class="warehouses-list">
        <ion-item *ngFor="let wh of warehouses" lines="none" class="warehouse-item">
          <ion-icon slot="start" name="business-outline"></ion-icon>
          <ion-label>
            <h2>{{ wh.name }}</h2>
            <p class="code">{{ wh.code }}</p>
            <p *ngIf="wh.address" class="address">{{ wh.address }}</p>
            <p *ngIf="wh.comments" class="comments">{{ wh.comments }}</p>
          </ion-label>
        </ion-item>
      </ion-list>
    </ng-container>
  </section>

  <!-- Toast -->
  <ion-toast [isOpen]="isToastOpen" [message]="toastMessage" [duration]="2000" color="medium" position="bottom"
    (didDismiss)="isToastOpen = false">
  </ion-toast>
</ion-content>